{% extends "base.html" %}

{% block link %}

<link rel="stylesheet" href="{{ STATIC_URL }}file_upload/css/style.css" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html">
    <link rel="stylesheet" href="{{ STATIC_URL }}file_upload/css/jquery.fileupload-ui.css">
    <link rel="stylesheet" href="{{ STATIC_URL }}file_upload/css/jquery.fileupload.css">

    <style type="text/css">
    </style>
    <script type="text/javascript">
        function checkSubmit(){

            if($('#name').val() == ''){
                alert("分类名称必须填写");
                return false;
            }
            if($('#name').val().length != 4){
                alert("分类名必须是四个字");
                return false
            }

            var name_array = new Array();
            {% for k, v in name_dict.iteritems %}
                name_array[{{ k }}] = '{{ v }}';
            {% endfor %}
            if($.inArray($('#name').val(), name_array) != -1){
                alert($('#name').val() + " 这个分类名已经存在！");
                return false
            }
            if($('#short-name').val() == ''){
                alert('名字简称必须填写');
                return false;
            }
            if($('#short-name').val().length != 2){
                alert("名字简称必须是两个字")
                return false
            }
            var rank = $('#rank').val();
            if(rank != '' && isNaN(rank)){
                alert('排序值必须为数字');
                return false;
            }
            var rank_list_str = '{{ rank_list_str }}'
            var rank_array = rank_list_str.split(',')
            if($.inArray(rank, rank_array) != -1){
                alert(rank + " 这个排序值已经存在！");
                return false
            }

        }
    </script>
    
{% endblock %}


{% block content%}
    <div id="form_div">
    <h3>&nbsp;*&nbsp;为必填项</h3>

    <form id='category-info'  method="post" onsubmit="return checkSubmit();">{% csrf_token %}
        <div class="row-fluid">
            <div class="span1">
            </div>
            <div class="span2">
                <h4>分类名称</h4>
            </div>

            <div class="span7">
                 <input id='name' name='name' class="input-xlarge" type="text">
                 <span class="text-error" style="margin-left: 16px;font-size: x-small ;font-weight: bold">* </span>
            </div>

        </div>
        <div class="row-fluid">
            <div class="span1">
            </div>
            <div class="span2">
                <h4>名字简称</h4>
            </div>

            <div class="span7">
                 <input id='short-name' name='short-name' class="input-xlarge" type="text">
                 <span class="text-error" style="margin-left: 16px;font-size: x-small ;font-weight: bold">* </span>
            </div>

        </div>

        <div class="row-fluid">
            <div class="span1">
            </div>
            <div class="span2">
                <h4>排序值</h4>
            </div>

            <div class="span7">
                 <input id='rank' name='rank' class="input-xlarge" type="text">
                 <span class="text-error" style="margin-left: 16px;font-size: x-small ;font-weight: bold">必须是正整数</span>
            </div>

            <div class="span1">

            </div>

        </div>
        <div class="row-fluid">
            <div class="span8">
            </div>
            <div class="span4">
                <input id="sub" type="submit" value="保存" class="btn btn-primary">
            </div>
        </div>
    </form>


    </div>

    <div  id="form_success"  style="display: none">
        <div id="floater" style="float:left; height:200px; margin-bottom:-120px;"></div>

        <div class="alert alert-success" style="width: 600px;margin: auto auto;clear:both; height:240px; position:relative;">
            <h1>Success！</h1>
            <p>保存应用成功<span style="margin: 10px"><a href="/app/add"> &gt;&gt;&gt;继续添加</a></span><span><a href="/app/list"> &gt;&gt;&gt;应用列表</a></span></p>
        </div>
    </div>


{% endblock %}

<!-- 添加自己的js文件-->
{% block js %}

    <script src="{{ STATIC_URL }}file_upload/js/vendor/jquery.ui.widget.js"></script>
    <script src="{{ STATIC_URL }}file_upload/js/jquery.iframe-transport.js"></script>
    <script src="{{ STATIC_URL }}file_upload/js/jquery.fileupload.js"></script>
    <script src="{{ STATIC_URL }}raty/jquery.raty.min.js"></script>
    <script type="text/javascript">$('#star').raty({score: 3, path: "../static/img/"});</script>
    <script type="text/javascript">
    //判断只能输入正整数，并且长度不能大于8位
        $("input[name='rank']").keyup(function(){
            var tmptxt=$(this).val();
            $(this).val(tmptxt.replace(/\D|/g,''));
        }).bind("paste",function(){
                    var tmptxt=$(this).val();
                    $(this).val(tmptxt.replace(/\D|^0/g,''));
                }).css("ime-mode", "disabled");
    </script>
{% endblock %}


