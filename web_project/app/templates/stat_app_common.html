{% extends "base.html" %}

{% block link %}
    <script type="text/javascript" charset="utf-8">
    var stat='{{ stat_type }}';
    if (stat == "push") {
        combo_dual_axes_push({{ categories|safe }},'{{ title|safe }}',{{ names|safe }},{{ datas|safe }},'{{ pop_trend_container|safe }}');
    }else{
        combo_dual_axes({{ categories|safe }},'{{ title|safe }}',{{ names|safe }},{{ datas|safe }},'{{ pop_trend_container|safe }}');
    }

    </script>

{% endblock %}

{% block content %}

    <div class="row-fluid" >
        <form role="form" action="/stat/app/{{ stat_type }}" id='index_query'>
            <input type="hidden" name='time_type' id='time_type' value="{{ time_type }}"/>
            <table class="table table-condensed">
                <tr>
                    <td>
                        <div class="time">
                            <div class="controls input-append date form_date" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                <span class="add-on">从：</span>
                                <span class="add-on"><i class="icon-th"></i></span>
                                <input type="text" value="{{ date_from }}" readonly id='date_from' name="date_from">
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="time">
                            <div class="controls input-append date form_date" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                <span class="add-on">到：</span>
                                <span class="add-on"><i class="icon-th"></i></span>
                                <input type="text" value="{{ date_to }}" readonly id='date_to' name="date_to">
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="input-prepend">
                            <span class="add-on">产品：</span>
                            <select id='product_select' class="span8" name='product_select'>
                                {% for ele in products %}
                                    {% if ele.selected %}
                                        <option value="{{ ele.value }}" selected='{{ ele.selected }}'>{{ ele.name }}</option>
                                    {% else %}
                                        <option value="{{ ele.value }}">{{ ele.name }}</option>
                                    {% endif %}

                                {% endfor %}

                            </select>
                        </div>
                    </td>
                    <td>
                        <div class="input-prepend">
                            <span class="add-on">平台：</span>
                            <select id='platform_select' class="span8" name='platform_select'>
                                {% for ele in platform %}
                                    {% if ele.selected %}
                                        <option value="{{ ele.value }}" selected='{{ ele.selected }}'>{{ ele.name }}</option>
                                    {% else %}
                                        <option value="{{ ele.value }}">{{ ele.name }}</option>
                                    {% endif %}
                                {% endfor %}

                            </select>
                        </div>
                    </td>
                    <td>
                        <div class="input-prepend">
                            <span class="add-on">终端：</span>
                            <select id='device_select' class="span8" name='device_select'>
                                {% for ele in devices %}
                                    {% if ele.selected %}
                                        <option value="{{ ele.value }}" selected='{{ ele.selected }}'>{{ ele.name }}</option>
                                    {% else %}
                                        <option value="{{ ele.value }}">{{ ele.name }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                    </td>
                    <td>
                        <div class="input-prepend">
                            <span class="add-on">应用名称：</span>
                            <select id='app_select' class="span8" name='app_select'>
                                <option value="0">全部</option>
                                {% for ele in apps %}
                                    {% if ele.selected %}
                                        <option value="{{ ele.value }}" selected='{{ ele.selected }}'>{{ ele.name }}</option>
                                    {% else %}
                                        <option value="{{ ele.value }}">{{ ele.name }}</option>
                                    {% endif %}
                                {% endfor %}

                            </select>
                        </div>
                    </td>
                    {#                        <td>#}
                    {#                            <div class="btn-group">#}
                    {#                                <button class="btn {{ time_type_day_class }}" time_type='1' id='query_btn_day'>按日</button>#}
                    {#                                <button class="btn {{ time_type_week_class }}" time_type='2' id='query_btn_week'>按周</button>#}
                    {#                                <button class="btn {{ time_type_month_class }}" time_type='3' id='query_btn_month'>按月</button>#}
                    {#                            </div>#}
                    {#                        </td>#}
{#                    <td>#}
{#                        <button type="button" class="btn btn-success" id='query_btn' time_type='0'>查询</button>#}
{#                    </td>#}
                </tr>
            </table>
            <div class="row-fluid">
                <div class="span12 text-center">
                    <button type="button" class="btn btn-success" id='query_btn' time_type='0'>查询</button>
                </div>
            </div>

        </form>
    </div>

    <div class="row-fluid" id="{{ pop_trend_container }}"><!-- 弹窗趋势图--></div>
    <div class="row-fluid">
        <div class="span12">
            <table class="table table-hover table-bordered">
                <h4>报表列表</h4>
                <thead>
                <tr>
                    <th>日期</th>
                    {% for ele in tab_names %}
                        <th>{{ ele }}</th>
                    {% endfor %}
                </tr>
                </thead>
                <tbody>
                {% for items in items_list %}
                    <tr>
                        {% for item in items %}
                            <td>{{ item }}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

{% endblock %}

{% block js %}
    <script type="text/javascript">

        $('#query_btn,#query_btn_day,#query_btn_week,#query_btn_month').click(function (e) {

            if ($(this).attr('id') != 'query_btn')
                $('#time_type').val($(this).attr('time_type'));
            $('#index_query').submit()
        });
    </script>
{% endblock %}